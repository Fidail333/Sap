version: '3.9'
services:
  web:
    build: .
    ports:
      - '3000:3000'
    environment:
      NEXT_PUBLIC_SITE_URL: http://localhost:3000
      ENABLE_SMTP: ${ENABLE_SMTP:-false}
      ENABLE_TELEGRAM: ${ENABLE_TELEGRAM:-false}
      SMTP_HOST: ${SMTP_HOST:-}
      SMTP_PORT: ${SMTP_PORT:-587}
      SMTP_USER: ${SMTP_USER:-}
      SMTP_PASS: ${SMTP_PASS:-}
      REQUEST_TO_EMAIL: ${REQUEST_TO_EMAIL:-}
      REQUEST_FROM_EMAIL: ${REQUEST_FROM_EMAIL:-}
      TELEGRAM_BOT_TOKEN: ${TELEGRAM_BOT_TOKEN:-}
      TELEGRAM_CHAT_ID: ${TELEGRAM_CHAT_ID:-}

  scraper:
    image: python:3.11-slim
    working_dir: /app
    volumes:
      - .:/app
    command: >
      bash -lc "pip install -r scripts/scrape/requirements.txt && python scripts/scrape/scrape.py"
